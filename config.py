import json
import os
import discord
import aiohttp
import io

DATA_FILE = "data.json"

# =========================================
# ЁЯУЭ р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф (MESSAGES)
# =========================================
MESSAGES = {
    # --- р╕гр╕░р╕Ър╕Ър╕Чр╕▒р╣Ир╕зр╣Др╕Ы ---
    "no_permission": "ЁЯЪл р╕Др╕╕р╕Ур╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Щр╕╡р╣Й",
    "cmd_success": "тЬЕ р╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",
    "loading": "тП│ р╕Бр╕│р╕ер╕▒р╕Зр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е...",
    "processing": "тЪЩя╕П р╕Бр╕│р╕ер╕▒р╕Зр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕г...",
    "msg_error_num": "тЭМ р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕гр╕нр╕Бр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ",
    
    # --- Admin Point Commands ---
    "pt_add_success": "тЬЕ р╣Ар╕Юр╕┤р╣Ир╕б {amount} р╣Бр╕Хр╣Йр╕б р╣Гр╕лр╣Йр╕Бр╕▒р╕Ъ {user} р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",
    "pt_remove_success": "тЬЕ р╕ер╕Ъ {amount} р╣Бр╕Хр╣Йр╕б р╕нр╕нр╕Бр╕Ир╕▓р╕Б {user} р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",
    "pt_current": "р╣Бр╕Хр╣Йр╕бр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ: {points}",
    "insufficient_points": "тЭМ р╣Бр╕Хр╣Йр╕бр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╣Др╕бр╣Ир╕Юр╕н (р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г {cost} р╣Бр╕Хр╣Йр╕б)",
    "point_balance": "ЁЯТ░ р╣Бр╕Хр╣Йр╕бр╕Др╕Зр╣Ар╕лр╕ер╕╖р╕н: {points}",

    # --- System Admin ---
    "sys_add_admin": "тЬЕ р╣Ар╕Юр╕┤р╣Ир╕б {target} р╣Ар╕Ыр╣Зр╕Щр╣Бр╕нр╕Фр╕бр╕┤р╕Щ",
    "sys_already_admin": "тЪая╕П {target} р╣Ар╕Ыр╣Зр╕Щр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з",
    "sys_remove_admin": "тЬЕ р╕ер╕Ъ {target} р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╣Бр╕нр╕Фр╕бр╕┤р╕Щ",
    "sys_not_admin": "тЪая╕П {target} р╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Ар╕Ыр╣Зр╕Щр╣Бр╕нр╕Фр╕бр╕┤р╕Щ",
    "sys_add_support": "тЬЕ р╣Ар╕Юр╕┤р╣Ир╕б {target} р╣Ар╕Ыр╣Зр╕Щ Support",
    "sys_already_support": "тЪая╕П {target} р╣Ар╕Ыр╣Зр╕Щ Support р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з",
    "sys_remove_support": "тЬЕ р╕ер╕Ъ {target} р╕нр╕нр╕Бр╕Ир╕▓р╕Б Support",
    "sys_not_support": "тЪая╕П {target} р╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Ар╕Ыр╣Зр╕Щ Support",
    "sys_lockdown_set": "тЬЕ р╕Хр╕▒р╣Йр╕Зр╣Ар╕зр╕ер╕▓ Lockdown: {seconds} р╕зр╕┤р╕Щр╕▓р╕Чр╕╡",
    "sys_reset_done": "тЬЕ р╕гр╕╡р╣Ар╕Лр╣Зр╕Хр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",

    # --- Gamble Setup ---
    "gam_setup_1_msg": "ЁЯЫая╕П **Setup 1/3**\nр╣Ар╕ер╕╖р╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╕Ир╕░р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б р╣Бр╕ер╕░р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕Хр╣Йр╕Щ",
    "gam_setup_1_btn": "р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е (р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б/р╕гр╕╣р╕Ы)",
    "gam_modal_1_title": "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ",
    "gam_lbl_content": "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕╡р╣Ир╕Ир╕░р╣Ар╕Вр╕╡р╕вр╕Щ",
    "gam_lbl_img1": "р╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕гр╕╣р╕Ыр╕Ыр╕Б (Embed)",
    "gam_lbl_img2": "р╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕гр╕╣р╕Ыр╕Хр╕нр╕Щр╕кр╕╕р╣Ир╕б (Gacha Show)",
    "gam_lbl_btn_txt": "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Ыр╕╕р╣Ир╕бр╕кр╕╕р╣Ир╕б",
    "gam_lbl_cost": "р╕гр╕▓р╕Др╕▓р╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕кр╕╕р╣Ир╕б 1 р╕Др╕гр╕▒р╣Йр╕З",
    "gam_ph_cost": "р╣Гр╕кр╣Ир╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ",
    
    "gam_setup_2_msg": "ЁЯЫая╕П **Setup 2/3**\nр╣Ар╕ер╕╖р╕нр╕Бр╕Кр╣Ир╕нр╕З Log р╣Бр╕ер╕░р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Ар╕гр╕Чр╕гр╕▓р╕Зр╕зр╕▒р╕е",
    "gam_setup_2_btn_chance": "р╕Ыр╕гр╕▒р╕Ър╣Вр╕нр╕Бр╕▓р╕к (%)",
    "gam_setup_2_btn_img": "р╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕е",
    "gam_setup_2_next": "р╕Цр╕▒р╕Фр╣Др╕Ы тЮбя╕П",
    "gam_modal_chance_title": "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Вр╕нр╕Бр╕▓р╕к (р╕гр╕зр╕бр╕Хр╣Йр╕нр╕З 100%)",
    "gam_lbl_c1": "р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 1 (%)",
    "gam_lbl_c2": "р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 2 (%)",
    "gam_lbl_c3": "р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 3 (%)",
    "gam_lbl_c4": "р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 4 (%)",
    "gam_lbl_c5": "р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 5 (р╣Ар╕Бр╕ер╕╖р╕н) (%)",
    "gam_modal_img_title": "р╣Гр╕кр╣Ир╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕е (р╕Хр╕▓р╕бр╕ер╕│р╕Фр╕▒р╕Ъ)",
    "gam_lbl_i1": "р╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 1",
    "gam_lbl_i2": "р╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 2",
    "gam_lbl_i3": "р╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 3",
    "gam_lbl_i4": "р╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 4",
    "gam_lbl_i5": "р╕гр╕╣р╕Ыр╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И 5",

    "gam_setup_3_msg": "ЁЯЫая╕П **Setup 3/3**\nр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ър╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ",
    "gam_setup_3_btn": "р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Бр╕▓р╕гр╣Вр╕нр╕Щ",
    "gam_setup_finish": "тЬЕ р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ! р╕кр╕гр╣Йр╕▓р╕Зр╕лр╣Йр╕нр╕Зр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",
    "gam_modal_pay_title": "р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ",
    "gam_lbl_tm_txt": "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б TrueMoney",
    "gam_lbl_pp_txt": "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б PromptPay",
    "gam_lbl_phone": "р╣Ар╕Ър╕нр╕гр╣Мр╕зр╕нр╣Ар╕ер╕Ч (р╕гр╕▒р╕Ър╕Лр╕нр╕З)",
    "gam_lbl_qr": "р╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕гр╕╣р╕Ы QR Code",

    # --- Gamble User ---
    "gam_select_topup": "р╣Ар╕Хр╕┤р╕б Point (Top-up)",
    "gam_opt_tm": "TrueMoney Wallet",
    "gam_opt_pp": "PromptPay",
    
    "top_tm_modal_title": "р╣Ар╕Хр╕┤р╕бр╣Ар╕Зр╕┤р╕Щ TrueMoney (р╕Лр╕нр╕З)",
    "top_tm_lbl_link": "р╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕Лр╕нр╕Зр╕нр╕▒р╣Ир╕Зр╣Ар╕Ыр╕▓",
    "top_tm_sent": "тЬЕ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╣Йр╕з р╕гр╕нр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ...",
    "top_tm_log": "ЁЯзз **р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Ар╕Хр╕┤р╕бр╣Ар╕Зр╕┤р╕Щ (р╕Лр╕нр╕З)**\nЁЯСд р╕Ьр╕╣р╣Йр╣Ар╕Хр╕┤р╕б: {user}\nЁЯФЧ р╕ер╕┤р╣Йр╕Зр╕Др╣М: {link}",
    
    "top_pp_msg": "ЁЯПж **р╣Вр╕нр╕Щр╣Ар╕Зр╕┤р╕Щр╕Ьр╣Ир╕▓р╕Щ PromptPay**\nр╣Вр╕Ыр╕гр╕Фр╣Вр╕нр╕Щр╣Ар╕Зр╕┤р╕Щр╣Бр╕ер╕░р╕Бр╕Фр╕Ыр╕╕р╣Ир╕бр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Ир╕Зр╕кр╕ер╕┤р╕Ы",
    "top_pp_btn_confirm": "р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Бр╕▓р╕гр╣Вр╕нр╕Щ (р╕кр╣Ир╕Зр╕кр╕ер╕┤р╕Ы)",
    "top_slip_room_created": "тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕лр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╕кр╕ер╕┤р╕Ыр╣Бр╕ер╣Йр╕з: {channel}",
    "top_slip_wait": "{user} ЁЯз╛ р╣Вр╕Ыр╕гр╕Фр╕кр╣Ир╕Зр╕гр╕╣р╕Ыр╕кр╕ер╕┤р╕Ыр╣Гр╕Щр╕Кр╣Ир╕нр╕Зр╕Щр╕╡р╣Й\n-# р╕Ир╕░р╕бр╕╡р╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕бр╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╕░р╣Ар╕Хр╕┤р╕бр╕Юр╕нр╕вр╕Чр╣Мр╣Гр╕лр╣Й",
    "top_slip_received": "ЁЯУе р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕кр╕ер╕┤р╕Ыр╣Бр╕ер╣Йр╕з р╕Бр╕│р╕ер╕▒р╕Зр╣Ар╕гр╕╡р╕вр╕Бр╣Бр╕нр╕Фр╕бр╕┤р╕Щ...",
    "top_slip_log_embed": "ЁЯз╛ **р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Вр╕нр╕Щ (р╕кр╕ер╕┤р╕Ы)**\nЁЯСд р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й: {user}",
    "top_btn_give_point": "р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤ / р╣Гр╕лр╣Й Point",
    "top_modal_give_title": "р╕гр╕░р╕Ър╕╕р╕Ир╕│р╕Щр╕зр╕Щ Point",
    "top_lbl_amount": "р╕Ир╕│р╕Щр╕зр╕Щ Point",
    "top_success_dm": "тЬЕ р╣Ар╕Хр╕┤р╕бр╣Ар╕Зр╕┤р╕Щр╕кр╕│р╣Ар╕гр╣Зр╕И! р╕Др╕╕р╕Ур╣Др╕Фр╣Йр╕гр╕▒р╕Ъ {amount} Point",
    
    "play_anim_title": "ЁЯО░ р╕Бр╕│р╕ер╕▒р╕Зр╕кр╕╕р╣Ир╕б...",
    "play_result_title": "ЁЯОЙ р╕Ьр╕ер╕Бр╕▓р╕гр╕кр╕╕р╣Ир╕б",
    "play_result_desc": "р╕Др╕╕р╕Ур╣Др╕Фр╣Йр╕гр╕▒р╕Ъ: **р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Чр╕╡р╣И {rank}**",

    # --- Auction ---
    "auc_btn_default": "ЁЯТ│ р╣Ар╕Ыр╕┤р╕Фр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е",
    "auc_step1_title": "ЁЯУЭ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е (1/2)",
    "auc_lbl_start": "р╕гр╕▓р╕Др╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ",
    "auc_ph_start": "р╣Гр╕кр╣Ир╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ",
    "auc_lbl_step": "р╕Ър╕┤р╕Фр╕Др╕гр╕▒р╣Йр╕Зр╕ер╕░",
    "auc_ph_step": "р╣Гр╕кр╣Ир╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ",
    "auc_lbl_close": "р╕гр╕▓р╕Др╕▓р╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕е (Auto Buy)",
    "auc_ph_close": "р╣Гр╕кр╣Ир╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ",
    "auc_lbl_item": "р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Др╕Фр╣Й (р╕Кр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓)",
    "auc_step2_title": "ЁЯУЭ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е (2/2)",
    "auc_lbl_link": "р╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕кр╕┤р╕Щр╕Др╣Йр╕▓",
    "auc_ph_link": "р╣Гр╕кр╣Ир╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У",
    "auc_lbl_rights": "р╕кр╕┤р╕Чр╕Шр╕┤р╣М",
    "auc_ph_rights": "р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Вр╕▓р╕Ф / р╕кр╕┤р╕Чр╕Шр╣Мр╣Ар╕Кр╕┤р╕Зр╕Юр╕▓р╕Ур╕┤р╕Кр╕вр╣М",
    "auc_lbl_extra": "р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б",
    "auc_ph_extra": "р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б (р╣Др╕бр╣Ир╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ)",
    "auc_lbl_time": "р╣Ар╕зр╕ер╕▓р╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕е (р╕Кр╕К:р╕Щр╕Щ)",
    "auc_ph_time": "р╣Ар╕Кр╣Ир╕Щ 01:00 р╕Др╕╖р╕н 1 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З",
    "auc_prompt_step2": "ЁЯСЗ р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕Фр╕Ыр╕╕р╣Ир╕бр╕Фр╣Йр╕▓р╕Щр╕ер╣Ир╕▓р╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣И 2",
    "auc_btn_step2": "р╕Бр╕Фр╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е 2",
    "auc_err_num": "тЭМ р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕гр╕нр╕Бр╕Кр╣Ир╕нр╕Зр╕гр╕▓р╕Др╕▓р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ",
    "auc_err_time": "тЭМ р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Ар╕зр╕ер╕▓р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З (р╣Гр╕Кр╣Й р╕Кр╕К:р╕Щр╕Щ)",
    "auc_created_channel": "тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕Кр╣Ир╕нр╕Зр╕кр╣Ир╕Зр╕гр╕╣р╕Ыр╣Бр╕ер╣Йр╕зр╕Чр╕╡р╣И {channel}",
    "auc_wait_img_1": "{user} ЁЯУж р╕кр╣Ир╕Зр╕гр╕╣р╕Ыр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕Ур╕Чр╕╡р╣Ир╕Кр╣Ир╕нр╕Зр╕Щр╕╡р╣Й\n-# **р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╣Др╕Фр╣Йр╕лр╕ер╕▓р╕вр╕гр╕╣р╕Ыр╣Гр╕Щ 1 р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б** р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Бр╕кр╕Фр╕Зр╣Ар╕Ыр╣Зр╕Щр╕нр╕▒р╕ер╕Ър╕▒р╣Йр╕бр╕гр╕зр╕б",
    "auc_wait_img_2": "ЁЯз╛ р╣Вр╕Ыр╕гр╕Фр╕кр╣Ир╕Зр╕гр╕╣р╕Ы QR code р╕лр╕гр╕╖р╕нр╕Кр╣Ир╕нр╕Зр╕Чр╕▓р╕Зр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ\n-# р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕гр╕Зр╕Щр╕╡р╣Йр╕Ир╕░р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╣Ар╕Ьр╕вр╣Бр╕Юр╕гр╣И",
    "auc_img_received": "ЁЯУе р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕гр╕╣р╕Ыр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в р╕гр╕нр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕вр╕╖р╕Щр╕вр╕▒р╕Щ тП│",
    "auc_embed_request_title": "р╕Др╕│р╕Вр╕нр╣Ар╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕ер╣Гр╕лр╕бр╣И",
    "auc_btn_approve": "р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤",
    "auc_btn_deny": "р╣Др╕бр╣Ир╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤",
    "auc_lbl_deny_reason": "р╣Ар╕лр╕Хр╕╕р╕Ьр╕е",
    "auc_admin_approve_log": "тЬЕ р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е р╕кр╕гр╣Йр╕▓р╕Зр╕лр╣Йр╕нр╕Зр╕Чр╕╡р╣И {channel}",
    "auc_modal_deny_title": "р╣Ар╕лр╕Хр╕╕р╕Ьр╕ер╕Бр╕▓р╕гр╣Др╕бр╣Ир╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤",
    "auc_deny_msg": "тЭМ р╕Ыр╕Пр╕┤р╣Ар╕кр╕Шр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕ер╣Бр╕ер╣Йр╕з",
    "auc_log_deny_title": "ЁЯЪл р╣Др╕бр╣Ир╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е",
    "auc_embed_title": "# ╦ЪтВКтАзъТ░сГР тШЖ р╗ТъТ▒ тАзтВК╦Ъ\n*ЁЯФе р╣Ар╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕е!*",
    "auc_btn_force_close": "ЁЯз╛ р╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕е",
    "auc_closing": "ЁЯЫС р╕Бр╕│р╕ер╕▒р╕Зр╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕е...",
    "auc_no_data": "тЭМ р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф р╣Др╕бр╣Ир╕Юр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е",
    "auc_bid_response": "# {user} р╕гр╕▓р╕Др╕▓ {amount}",
    "auc_bid_outbid": "\n{old_winner} р╣Вр╕Фр╕Щр╕Щр╕│р╣Бр╕ер╣Йр╕з!",
    "auc_bid_autobuy": "\n-# тЪая╕Пр╕Цр╕╢р╕Зр╕гр╕▓р╕Др╕▓р╕Ыр╕┤р╕Фр╕Ыр╕гр╕░р╕бр╕╣р╕ер╣Бр╕ер╣Йр╕з р╕Ир╕░р╕Ыр╕┤р╕Фр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕лр╕▓р╕Бр╣Др╕бр╣Ир╕бр╕╡р╣Гр╕Др╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Гр╕Щ 10 р╕Щр╕▓р╕Чр╕╡",
    "auc_end_winner": "ЁЯОЙ **р╕Ир╕Ър╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е!**\nЁЯУЬ р╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣И {count} | р╕Ьр╕╣р╣Йр╕Кр╕Щр╕░: {winner}\nЁЯТ░ р╕Ир╕Ър╕Чр╕╡р╣Ир╕гр╕▓р╕Др╕▓: **{price} р╕Ър╕▓р╕Ч**\n-# ЁЯФР р╕Кр╣Ир╕нр╕Зр╕Щр╕╡р╣Йр╕Ир╕░р╕Цр╕╣р╕Бр╕ер╣Зр╕нр╕Др╣Гр╕Щ {time} р╕зр╕┤р╕Щр╕▓р╕Чр╕╡",
    "auc_end_no_bid": "тЪая╕П **р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕ер╕Ир╕Ър╕ер╕З (р╣Др╕бр╣Ир╕бр╕╡р╕Ьр╕╣р╣Йр╕Ыр╕гр╕░р╕бр╕╣р╕е)**\nЁЯУЬ р╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣И {count} | р╕Ьр╕╣р╣Йр╕Вр╕▓р╕в: {seller}",
    "auc_lock_msg": "ЁЯФР **р╕Кр╣Ир╕нр╕Зр╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕зр╣Бр╕ер╣Йр╕з**\n({winner} р╕Ьр╕╣р╣Йр╕Кр╕Щр╕░р╕Ыр╕гр╕░р╕бр╕╣р╕е) р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╕гр╕▒р╕Ъ",
    "auc_btn_confirm": "р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕ЩтЬЕ",
    "auc_btn_cancel": "р╕вр╕Бр╣Ар╕ер╕┤р╕БтЭМ",
    "auc_btn_double_confirm": "р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕З",
    "auc_check_money": "тЪая╕П р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Гр╕лр╣Йр╣Бр╕Щр╣Ир╣Гр╕Ир╕зр╣Ир╕▓р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╣Ар╕Зр╕┤р╕Щр╣Бр╕ер╣Йр╕з р╕Чр╕▓р╕Зр╣Ар╕гр╕▓р╕Ир╕░р╣Др╕бр╣Ир╕гр╕▒р╕Ър╕Ьр╕┤р╕Фр╕Кр╕нр╕Ър╣Гр╕Фр╣Ж",
    "auc_modal_cancel_title": "р╣Ар╕лр╕Хр╕╕р╕Ьр╕ер╕Бр╕▓р╕гр╕вр╕Бр╣Ар╕ер╕┤р╕Б",
    "auc_msg_cancel_success": "тЬЕ р╕вр╕Бр╣Ар╕ер╕┤р╕Бр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в р╕ер╕Ър╕Кр╣Ир╕нр╕Зр╣Гр╕Щ 5 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡",
    "auc_dm_success": "тЬЕ р╕кр╣Ир╕Зр╕ер╕┤р╣Йр╕Зр╕Др╣Мр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Чр╕▓р╕З DM р╣Бр╕ер╣Йр╕зр╕Др╕гр╕▒р╕Ъ",
    "auc_dm_fail": "тЪая╕П р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕З DM р╕лр╕▓ {user} р╣Др╕Фр╣Й (р╣Ар╕Вр╕▓р╕нр╕▓р╕Ир╕Ыр╕┤р╕Ф DM)",
    "auc_dm_content": "ЁЯУж **р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У:**\n{link}",
    "auc_success_log": "тФАтФА .тЬж ЁЭРТЁЭРоЁЭРЬЁЭРЬЁЭРЮЁЭРмЁЭРм тЬж. тФАтФА\nтХня╣ХЁЯУЬ р╕Ыр╕гр╕░р╕бр╕╣р╕ер╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣И - {count}\n | я╣ХЁЯСд р╣Вр╕Фр╕в {seller}\n | я╣ХЁЯПЖ р╕Ьр╕╣р╣Йр╕Кр╕Щр╕░ {winner}\nтХ░ я╣ХЁЯТ░ р╕Ир╕Ър╕Чр╕╡р╣Ир╕гр╕▓р╕Др╕▓ : {price}",
    "auc_cancel_log": "тХня╣ХЁЯЪл **р╕вр╕Бр╣Ар╕ер╕┤р╕Бр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕╣р╕е** р╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣И {count}\n | я╣ХЁЯСд р╣Вр╕Фр╕в {seller}\n | я╣ХтЭМ р╕вр╕Бр╣Ар╕ер╕┤р╕Бр╣Вр╕Фр╕в {user}\nтХ░ я╣ХЁЯУЭ р╣Ар╕лр╕Хр╕╕р╕Ьр╕е : {reason}",

    # --- Ticket ---
    "tf_setup_success": "тЬЕ р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Forum {forum} р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",
    "tf_guide_msg": "ЁЯСЗ р╕Бр╕Фр╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Хр╕гр╕Зр╕Щр╕╡р╣Й",
    "tf_btn_buy": "ЁЯЫТ р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н (Tickets)",
    "tf_btn_buying": "тП│ р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╕Лр╕╖р╣Йр╕н",
    "tf_btn_report": "ЁЯЪй р╕гр╕▓р╕вр╕Зр╕▓р╕Щ",
    "tf_err_own_post": "тЭМ р╕Др╕╕р╕Ур╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕Зр╣Др╕Фр╣Й",
    "tf_err_own_report": "тЭМ р╕Др╕╕р╕Ур╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Вр╕Юр╕кр╕Хр╣Мр╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕Зр╣Др╕Фр╣Й",
    "tf_only_seller": "ЁЯЪл р╣Ар╕Йр╕Юр╕▓р╕░ **р╕Ьр╕╣р╣Йр╕Вр╕▓р╕в** р╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щр╕Чр╕╡р╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Бр╕Фр╕Ыр╕╕р╣Ир╕бр╕Щр╕╡р╣Йр╣Др╕Фр╣Й",
    "tf_room_created": "ЁЯФР **р╕Кр╣Ир╕нр╕Зр╕Лр╕╖р╣Йр╕нр╕Вр╕▓р╕вр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з**\nЁЯСд р╕Ьр╕╣р╣Йр╕Лр╕╖р╣Йр╕н: {buyer}\nЁЯСд р╕Ьр╕╣р╣Йр╕Вр╕▓р╕в: {seller}\n-# р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Ир╕гр╕Ир╕▓р╣Бр╕ер╕░р╣Вр╕нр╕Щр╣Ар╕Зр╕┤р╕Щр╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╕гр╕▒р╕Ъ",
    "tf_wait_admin": "ЁЯФФ р╕Бр╕│р╕ер╕▒р╕Зр╣Ар╕гр╕╡р╕вр╕Бр╣Бр╕нр╕Фр╕бр╕┤р╕Щр╕бр╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ...",
    "tf_admin_panel_msg": "ЁЯЫбя╕П р╕Ыр╕╕р╣Ир╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕нр╕Фр╕бр╕┤р╕Щ:",
    "tf_btn_finish": "р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ(р╕Ыр╕┤р╕Фр╕Кр╣Ир╕нр╕З)",
    "tf_btn_cancel": "р╕вр╕Бр╣Ар╕ер╕┤р╕Б",
    "tf_btn_admin_close": "р╕Ыр╕┤р╕Фр╕Кр╣Ир╕нр╕Зр╣Бр╕ер╕░р╕ер╕Ър╣Вр╕Юр╕кр╕Хр╣М",
    "tf_modal_report_title": "р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Вр╕Юр╕кр╕Хр╣М",
    "tf_lbl_reason": "р╣Ар╕лр╕Хр╕╕р╕Ьр╕е",
    "tf_msg_report_success": "тЬЕ р╕кр╣Ир╕Зр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в",
    "tf_modal_cancel_title": "р╣Ар╕лр╕Хр╕╕р╕Ьр╕ер╕Бр╕▓р╕гр╕вр╕Бр╣Ар╕ер╕┤р╕Б",
    "tf_log_report_title": "ЁЯЪй р╕бр╕╡р╕Бр╕▓р╕гр╕гр╕▓р╕вр╕Зр╕▓р╕Щр╣Вр╕Юр╕кр╕Хр╣М",
    "tf_log_cancel_title": "тЭМ ЁЭЧзЁЭЧ┐ЁЭЧоЁЭЧ╗ЁЭШАЁЭЧоЁЭЧ░ЁЭШБЁЭЧ╢ЁЭЧ╝ЁЭЧ╗ ЁЭЧЦЁЭЧоЁЭЧ╗ЁЭЧ░ЁЭЧ▓ЁЭЧ╣ЁЭЧ╣ЁЭЧ▓ЁЭЧ▒",
    "tf_log_cancel_desc": "р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Цр╕╣р╕Бр╕вр╕Бр╣Ар╕ер╕┤р╕Б (Ticket ID-{count})",
    "tf_log_success_title": "тЬЕ ЁЭЧзЁЭЧ┐ЁЭЧоЁЭЧ╗ЁЭШАЁЭЧоЁЭЧ░ЁЭШБЁЭЧ╢ЁЭЧ╝ЁЭЧ╗ ЁЭЧЦЁЭЧ╝ЁЭЧ║ЁЭЧ╜ЁЭЧ╣ЁЭЧ▓ЁЭШБЁЭЧ▓ЁЭЧ▒",
    "tf_log_success_desc": "р╕Шр╕╕р╕гр╕Бр╕гр╕гр╕бр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ (Ticket ID-{count})",
}

# =========================================
# HELPER FUNCTIONS
# =========================================
def load_data():
    if not os.path.exists(DATA_FILE):
        return {
            "admins": [], "supports": [], "auction_count": 0, "ticket_count": 0,
            "ticket_configs": {}, "lockdown_time": 0, "points": {} 
        }
    with open(DATA_FILE, "r", encoding="utf-8") as f:
        return json.load(f)

def save_data(data):
    with open(DATA_FILE, "w", encoding="utf-8") as f:
        json.dump(data, f, indent=4, ensure_ascii=False)

def is_admin_or_has_permission(interaction: discord.Interaction):
    data = load_data()
    user_id = interaction.user.id
    user_roles = [r.id for r in interaction.user.roles]
    if user_id in data["admins"] or any(r in data["admins"] for r in user_roles): return True
    if interaction.user.guild_permissions.administrator: return True
    return False

def is_support_or_admin(interaction: discord.Interaction):
    if is_admin_or_has_permission(interaction): return True
    data = load_data()
    user_id = interaction.user.id
    user_roles = [r.id for r in interaction.user.roles]
    if user_id in data["supports"] or any(r in data["supports"] for r in user_roles): return True
    return False

async def get_files_from_urls(urls):
    files = []
    async with aiohttp.ClientSession() as session:
        for i, url in enumerate(urls):
            try:
                async with session.get(url) as resp:
                    if resp.status == 200:
                        data = await resp.read()
                        files.append(discord.File(io.BytesIO(data
